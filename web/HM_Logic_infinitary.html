<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory HM_Logic_infinitary</title>
</head>


<body>
<div class="head">
<h1>Theory HM_Logic_infinitary</h1>
</div>

<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> HM_Logic_infinitary
  <span class="keyword2"><span class="keyword">imports</span></span> 
    <a href="Strong_Bisimilarity.html">Strong_Bisimilarity</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">chapter</span></span> <span class="quoted"><span class="plain_text">‹Infinitary Hennessy-Milner Logic›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹\label{chap:HML_infinitary}›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹We will show that a modal characterisation of strong bisimilarity is possible without any assumptions about the cardinality of derivative sets <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Der(p, α)›</span></span></span></span>, using infinitary HML (with conjunction of arbitrary cardinality). 

Instead of formalising formulas under a conjunction as a countable set,%
\footnote{Note that it is impossible to define a type with a constructor depending on a set of the type itself, i.e.\@ <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>HML_conj ‹('a)HML_formula set››</span></span></span></span> would not yield a valid type.}
we use an index set of arbitrary type <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>I :: 'x set›</span></span></span></span> and a mapping \linebreak <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>F :: 'x ⇒ ('a, 'x)HML_formula›</span></span></span></span> so that each element of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>I›</span></span></span></span> is mapped to a formula. This closely resembles the semantics of $\bigwedge_{i \in I} \varphi_i$. Instead of using partial mappings <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>F :: 'x ⇒ ('a, 'x)HML_formula option›</span></span></span></span>, I included a constructor <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>HML_true›</span></span></span></span> and implicitly assume that <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>F›</span></span></span></span> maps to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>HML_true›</span></span></span></span> for all objects of type <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>'x›</span></span></span></span> that are not elements of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>I›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'x</span><span class="main">)</span>HML_formula <span class="main">=</span>
  HML_true 
<span class="main">|</span> HML_conj <span class="quoted"><span class="quoted">‹<span class="tfree">'x</span> set›</span></span> <span class="quoted"><span class="quoted">‹<span class="tfree">'x</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'x</span><span class="main">)</span>HML_formula›</span></span> 
<span class="main">|</span> HML_neg <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'x</span><span class="main">)</span>HML_formula›</span></span> 
<span class="main">|</span> HML_poss <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'x</span><span class="main">)</span>HML_formula›</span></span> 


<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Satisfaction Relation›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Data types cannot be used with arbitrary parameter types <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>'x›</span></span></span></span> in concrete contexts; so when using our data type in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>context lts›</span></span></span></span>, we use the type of processes <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>'s›</span></span></span></span> as the type for conjunction index sets. 

\pagebreak
Since this suffices to proof the modal characterisation, we can conclude that it suffices for the cardinality of conjunction to be equal to the cardinality of the set of processes $\Proc$. As we can deduce from the part of the proof where formula conjunction is used, a weaker requirement would be to allow for conjunction of cardinality equal to $\displaystyle\max_{\substack{p\in\Proc \\ \alpha\in\Act}} |\text{Der}(p, \alpha)|$.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Isabelle›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The formalisation of this appendix follows the same structure as that in \cref{sec:HML}. The explanations from there mostly apply here as well.›</span></span>

<span class="keyword1"><span class="command">context</span></span> lts <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">function</span></span> <span class="entity">satisfies</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'s</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'s</span><span class="main">)</span> HML_formula <span class="main">⇒</span> bool›</span></span> 
  <span class="main">(</span><span class="quoted">‹_ <span class="keyword1">⊨</span> _›</span> <span class="main">[</span>50<span class="main">,</span> 50<span class="main">]</span> 50<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⊨</span></span> HML_true<span class="main">)</span> <span class="main">=</span> True›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⊨</span></span> HML_conj <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">i</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⊨</span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="bound">i</span><span class="main">)</span><span class="main">)</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⊨</span></span> HML_neg <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">¬</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⊨</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⊨</span></span> HML_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">p'</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main"><span class="free">⟼</span></span><span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="bound">p'</span> <span class="main">∧</span> <span class="bound">p'</span> <span class="main"><span class="free">⊨</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> HML_formula.exhaust <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span><span class="main"><span class="keyword3">,</span></span> <span class="operator">blast</span><span class="main">)</span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">HML_wf_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'s</span> <span class="main">×</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'s</span><span class="main">)</span> HML_formula<span class="main">)</span> rel›</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">F</span></span></span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">i</span></span></span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="main">⟹</span> <span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> HML_conj <span class="free"><span class="bound"><span class="entity">I</span></span></span> <span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">HML_wf_rel</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> HML_neg <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">HML_wf_rel</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span><span class="main">,</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p'</span></span></span><span class="main">,</span> HML_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="free">HML_wf_rel</span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> HML_wf_rel_is_wf<span class="main">:</span> <span class="quoted"><span class="quoted">‹wf HML_wf_rel›</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> wf_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'s</span> <span class="main">×</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'s</span><span class="main">)</span> HML_formula <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">t</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="tfree">'s</span> <span class="main">×</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'s</span><span class="main">)</span> HML_formula›</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">p</span></span> <span class="skolem"><span class="skolem">φ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span> <span class="skolem">φ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> HML_wf_rel <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">y</span><span class="main">)</span> <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">x</span>›</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span> <span class="skolem">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">φ</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="skolem">p</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> HML_formula.ctr_transfer<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> HML_formula.rel_distinct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> HML_wf_relp.cases HML_wf_relp_HML_wf_rel_eq surj_pair<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>10<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span> HML_formula.inject<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> HML_wf_rel_def UNIV_I case_prodE' image_eqI lts.HML_wf_rel.cases mem_Collect_eq split_conv<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> ccfv_threshold<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>7<span class="main"><span class="main">)</span></span> HML_formula.inject<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> case_prodI2 case_prod_curry lts.HML_wf_rel.cases lts.HML_wf_rel_def<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> del_insts<span class="main"><span class="main">)</span></span> HML_formula.distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">,</span></span>5<span class="main"><span class="main">,</span></span>9<span class="main"><span class="main">,</span></span>11<span class="main"><span class="main">)</span></span>  HML_formula.inject<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> HML_wf_rel.cases case_prodD case_prodE' lts.HML_wf_rel_def mem_Collect_eq<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span> <span class="skolem">t</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">p</span><span class="main">,</span> <span class="skolem">φ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">termination</span></span><span class="comment1">✐<span class="quoted"><span class="quoted">‹tag <span class="main"><span class="main">(</span></span>proof<span class="main"><span class="main">)</span></span> visible›</span></span></span> <span class="quoted">satisfies</span> <span class="keyword1"><span class="command">using</span></span> HML_wf_rel_is_wf 
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">standard</span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> HML_wf_rel.intros<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹\newpage›</span></span>
<span class="keyword1"><span class="command">subsubsection</span></span> <span class="quoted"><span class="plain_text">‹Modal Characterisation of Strong Bisimilarity›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">HML_equivalent</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'s</span> <span class="main">⇒</span> <span class="tfree">'s</span> <span class="main">⇒</span> bool›</span></span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">HML_equivalent</span> <span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="free"><span class="bound"><span class="entity">q</span></span></span> 
    <span class="main">≡</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">φ</span><span class="main">::</span><span class="main">(</span><span class="tfree">'a</span><span class="main">,</span> <span class="tfree">'s</span><span class="main">)</span> HML_formula<span class="main">.</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">p</span></span></span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span> <span class="main">⟷</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">q</span></span></span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> distinguishing_formula<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> HML_equivalent <span class="free">p</span> <span class="free">q</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="free">p</span> <span class="main">⊨</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">q</span> <span class="main">⊨</span> <span class="bound">φ</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">φ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">⊨</span> <span class="skolem">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">q</span> <span class="main">⊨</span> <span class="skolem">φ</span> <span class="main">∨</span> <span class="free">q</span> <span class="main">⊨</span> <span class="skolem">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">p</span> <span class="main">⊨</span> <span class="skolem">φ</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> HML_equivalent_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">elim</span> disjE<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="free">q</span> <span class="main">⊨</span> <span class="skolem">φ</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">p</span> <span class="main">⊨</span> <span class="skolem">φ</span>›</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">q</span> <span class="main">⊨</span> <span class="skolem">φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">q</span> <span class="main">⊨</span> HML_neg <span class="skolem">φ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free">p</span> <span class="main">⊨</span> <span class="skolem">φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">⊨</span> HML_neg <span class="skolem">φ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">φ</span><span class="main">.</span> <span class="free">p</span> <span class="main">⊨</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">q</span> <span class="main">⊨</span> <span class="bound">φ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> HML_equivalent_symm<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹HML_equivalent <span class="free">p</span> <span class="free">q</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹HML_equivalent <span class="free">q</span> <span class="free">p</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> HML_equivalent_def assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>

<span class="keyword1"><span class="command">lemma</span></span><span class="comment1">✐<span class="quoted"><span class="quoted">‹tag <span class="main"><span class="main">(</span></span>proof<span class="main"><span class="main">)</span></span> visible›</span></span></span> strong_bisimilarity_implies_HML_equivalent<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">↔</span> <span class="free">q</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">⊨</span> <span class="free">φ</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">q</span> <span class="main">⊨</span> <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="free">φ</span></span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="free">p</span></span> <span class="quoted"><span class="free">q</span></span><span class="main">)</span>
  <span class="keyword3"><span class="command">case</span></span> HML_true
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>HML_conj <span class="skolem">X</span> <span class="skolem">F</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>HML_neg <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> satisfies.simps<span class="main">(</span>3<span class="main">)</span> strongly_bisimilar_symm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>HML_poss <span class="skolem">α</span> <span class="skolem">φ</span><span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> satisfies.simps<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> strongly_bisimilar_step<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹\newpage›</span></span>
<span class="keyword1"><span class="command">lemma</span></span><span class="comment1">✐<span class="quoted"><span class="quoted">‹tag <span class="main"><span class="main">(</span></span>proof<span class="main"><span class="main">)</span></span> visible›</span></span></span> HML_equivalence_is_SB<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹SB HML_equivalent›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="skolem">q</span> <span class="skolem">p'</span> <span class="skolem">α</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹HML_equivalent <span class="skolem">p</span> <span class="skolem">q</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main"><span class="free">⟼</span></span><span class="skolem">α</span> <span class="skolem">p'</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">q'</span> <span class="main">∈</span> <span class="keyword1">Der(</span><span class="skolem">q</span><span class="main">,</span> <span class="skolem">α</span><span class="main">)</span><span class="main">.</span> <span class="main">¬</span> HML_equivalent <span class="skolem">p'</span> <span class="bound">q'</span>›</span></span>
    
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted">"exists_φ<span class="hidden">⇘</span><sub>q'</sub><span class="hidden">⇙</span>"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">q'</span> <span class="main">∈</span> <span class="keyword1">Der(</span><span class="skolem">q</span><span class="main">,</span> <span class="skolem">α</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">φ</span><span class="main">.</span> <span class="skolem">p'</span> <span class="main">⊨</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="bound">q'</span> <span class="main">⊨</span> <span class="bound">φ</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> distinguishing_formula <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="keyword1">Der(</span><span class="skolem">q</span><span class="main">,</span> <span class="skolem">α</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span> <span class="bound">q'</span><span class="main">.</span> <span class="keyword1">SOME</span> <span class="bound">φ</span><span class="main">.</span> <span class="skolem">p'</span> <span class="main">⊨</span> <span class="bound">φ</span> <span class="main">∧</span> <span class="main">¬</span> <span class="bound">q'</span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?φ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹HML_conj <span class="var">?I</span> <span class="var">?F</span>›</span></span>
    
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted">"exists_φ<span class="hidden">⇘</span><sub>q'</sub><span class="hidden">⇙</span>"</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p'</span> <span class="main">⊨</span> <span class="var">?φ</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> satisfies.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> someI_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">⊨</span> HML_poss <span class="skolem">α</span> <span class="var">?φ</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main"><span class="free">⟼</span></span><span class="skolem">α</span> <span class="skolem">p'</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

    <span class="keyword1"><span class="command">from</span></span> <span class="quoted">"exists_φ<span class="hidden">⇘</span><sub>q'</sub><span class="hidden">⇙</span>"</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">q'</span> <span class="main">∈</span> <span class="keyword1">Der(</span><span class="skolem">q</span><span class="main">,</span> <span class="skolem">α</span><span class="main">)</span><span class="main">.</span> <span class="main">¬</span> <span class="bound">q'</span> <span class="main">⊨</span> <span class="var">?φ</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> satisfies.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> someI_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="skolem">q</span> <span class="main">⊨</span> HML_poss <span class="skolem">α</span> <span class="var">?φ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">p</span> <span class="main">⊨</span> HML_poss <span class="skolem">α</span> <span class="var">?φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="skolem">q</span> <span class="main">⊨</span> HML_poss <span class="skolem">α</span> <span class="var">?φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> 
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹HML_equivalent <span class="skolem">p</span> <span class="skolem">q</span>›</span></span> HML_equivalent_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>

  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹SB HML_equivalent›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> SB_def 
    <span class="keyword1"><span class="command">using</span></span> HML_equivalent_symm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

  
<span class="keyword1"><span class="command">theorem</span></span><span class="comment1">✐<span class="quoted"><span class="quoted">‹tag <span class="main"><span class="main">(</span></span>proof<span class="main"><span class="main">)</span></span> visible›</span></span></span> modal_characterisation_of_strong_bisimilarity<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">↔</span> <span class="free">q</span>  <span class="main">⟺</span>  <span class="main">(</span><span class="main">∀</span> <span class="bound">φ</span><span class="main">.</span> <span class="free">p</span> <span class="main">⊨</span> <span class="bound">φ</span> <span class="main">⟷</span> <span class="free">q</span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="free">p</span> <span class="main">↔</span> <span class="free">q</span> <span class="main">⟹</span> <span class="main">∀</span><span class="bound">φ</span><span class="main">.</span> <span class="main">(</span><span class="free">p</span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">q</span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> strong_bisimilarity_implies_HML_equivalent 
      strongly_bisimilar_symm 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">φ</span><span class="main">.</span> <span class="main">(</span><span class="free">p</span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">q</span> <span class="main">⊨</span> <span class="bound">φ</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">p</span> <span class="main">↔</span> <span class="free">q</span>›</span></span> 
    <span class="keyword1"><span class="command">using</span></span> HML_equivalence_is_SB HML_equivalent_def 
      strongly_bisimilar_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹of <span class="antiquoted"><span class="raw_text"><span class="operator">‹</span>context lts›</span></span>›</span>
<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹of ‹theory››</span>
<span class="comment1">(*&gt;*)</span></pre>
</body>

</html>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Mapping_for_Formulas</title>
</head>


<body>
<div class="head">
<h1>Theory Mapping_for_Formulas</h1>
</div>

<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> Mapping_for_Formulas
  <span class="keyword2"><span class="keyword">imports</span></span>
    <a href="Mapping_for_Transition_Systems.html">Mapping_for_Transition_Systems</a>
    <a href="HM_Logic.html">HM_Logic</a>
    <a href="HM_Logic_with_TimeOuts.html">HM_Logic_with_TimeOuts</a>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹A Mapping for Formulas›</span></span>
<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹\label{sec:mapping_formulas}›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹I will now introduce a mapping $\sigma(\cdot)$ that maps formulas of \HMLt{} to formulas of HML, in the context of the process mapping from \cref{sec:mapping_lts}, such that $\vartheta(p)$ satisfies $\sigma(\varphi)$ iff $p$ satisfies $\varphi$.

Again, we have $\mathbb{T} = (\Proc, \Act, \rightarrow)$ and $\mathbb{T}_\vartheta = (\Proc_\vartheta, \Act_\vartheta, \rightarrow_\vartheta)$ as defined in \cref{sec:mapping_lts}, with $A = \Act \!\setminus\! \{\tau, t\}$, and we assume that $t_\varepsilon \notin \Act$ and $\forall X \subseteq A.\; \varepsilon_X \notin \Act$.

Let $\sigma : (\text{\HMLt{} formulas}) \longrightarrow (\text{HML formulas})$ be recursively defined by
\begin{align*}
    \sigma(\textstyle\bigwedge_{i \in I} \varphi_i) =\;&amp; \textstyle\bigwedge_{i \in I} \sigma(\varphi_i) &amp;\\
    \sigma(\neg\varphi) =\;&amp; \neg\,\sigma(\varphi)\\
    \sigma(\langle\tau\rangle\varphi) =\;&amp; \langle\tau\rangle\,\sigma(\varphi)\\
    \sigma(\langle\alpha\rangle\varphi) =\;&amp; 
        \langle\alpha\rangle\,\sigma(\varphi)\;\vee\\
        &amp;\langle\varepsilon_A\rangle\langle\alpha\rangle\,\sigma(\varphi)\;\vee\\ 
        &amp;\langle{}t_\varepsilon\rangle\langle\varepsilon_A\rangle\langle\alpha\rangle\,\sigma(\varphi) &amp;&amp; \text{if $\alpha \in A$}\\
    \sigma(\langle\alpha\rangle\varphi) =\;&amp; f\!\!f &amp;&amp; \text{if $\alpha \notin A \cup \{\tau\}$}\\
    \sigma(\langle{}X\rangle\varphi) =\;&amp;
        \langle\varepsilon_X\rangle\langle{}t\rangle\,\sigma(\varphi)\;\vee\\
        &amp;\langle{}t_\varepsilon\rangle\langle\varepsilon_X\rangle\langle{}t\rangle\,\sigma(\varphi) &amp;&amp; \text{if $X \subseteq A$} \\
    \sigma(\langle{}X\rangle\varphi) =\;&amp; f\!\!f &amp;&amp; \text{if $X \not\subseteq A$}
\end{align*}

This mapping simply expresses the time-out semantics given by the satisfaction relations of \HMLt{} (\cref{sec:HMLt}) in terms of ordinary HML evaluated on our mapped LTS $\mathbb{T}_\vartheta$. The disjunctive clauses compensate for the additional environment transitions ($\varepsilon$-actions) that are not present in $\mathbb{T}$.
\pagebreak›</span></span>


<span class="keyword1"><span class="command">subsection</span></span> <span class="quoted"><span class="plain_text">‹Isabelle›</span></span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹The implementation of the mapping in Isabelle is rather straightforward, although some details might not be obvious: 

<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>cimage (λ φ. σ(φ)) Φ›</span></span></span></span> is the image of the countable set <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Φ›</span></span></span></span> under the function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>λ φ. σ(φ)›</span></span></span></span>, so it corresponds to $\{ \sigma(\varphi) \mid \varphi \in \Phi \}$ for countable $\Phi$.

<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>α ≠ τ ∧ α ≠ t ∧ α ≠ t_ε ∧ (∀ X. α ≠ ε[X])›</span></span></span></span> corresponds to $\alpha \in A$ with our assumption about there being no $\varepsilon$-actions in $\Act$. Similarly, \linebreak <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>α = t ∨ α = t_ε ∨ α = ε[X]›</span></span></span></span> corresponds to $\alpha \notin A \cup \{\tau\}$.›</span></span>

<span class="keyword1"><span class="command">context</span></span> lts_timeout_mappable <span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">function</span></span> <span class="entity">HMt_mapping</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">)</span>HMLt_formula <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">)</span>HML_formula›</span></span> 
  <span class="main">(</span><span class="quoted">‹<span class="keyword1">σ'(</span>_<span class="keyword1">')</span>›</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">σ(</span></span>HMLt_conj <span class="free"><span class="bound"><span class="entity">Φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_conj <span class="main">(</span>cimage <span class="main">(</span><span class="main">λ</span> <span class="bound">φ</span><span class="main">.</span> <span class="keyword1"><span class="free">σ(</span></span><span class="bound">φ</span><span class="main"><span class="free">)</span></span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">Φ</span></span></span><span class="main">)</span>›</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">σ(</span></span>HMLt_neg <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_neg <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span>›</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">=</span> <span class="free">τ</span> <span class="main">⟹</span>
      <span class="keyword1"><span class="free">σ(</span></span>HMLt_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span>›</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">≠</span> <span class="free">τ</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">≠</span> <span class="free">t</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">≠</span> <span class="free">t_ε</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">X</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">≠</span> <span class="keyword1"><span class="free">ε[</span></span><span class="bound">X</span><span class="main"><span class="free">]</span></span><span class="main">)</span> <span class="main">⟹</span>
      <span class="keyword1"><span class="free">σ(</span></span>HMLt_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_disj <span class="main">(</span>acset <span class="main">{</span>
        HML_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span><span class="main">,</span>
        HML_poss <span class="keyword1"><span class="free">ε[</span></span>visible_actions<span class="main"><span class="free">]</span></span> <span class="main">(</span>HML_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span><span class="main">,</span>
        HML_poss <span class="free">t_ε</span> <span class="main">(</span>HML_poss <span class="keyword1"><span class="free">ε[</span></span>visible_actions<span class="main"><span class="free">]</span></span> <span class="main">(</span>HML_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span><span class="main">)</span>
      <span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">=</span> <span class="free">t</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">=</span> <span class="free">t_ε</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="main">=</span> <span class="keyword1"><span class="free">ε[</span></span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main"><span class="free">]</span></span> <span class="main">⟹</span>
      <span class="keyword1"><span class="free">σ(</span></span>HMLt_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_false›</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">⊆</span> visible_actions <span class="main">⟹</span>
      <span class="keyword1"><span class="free">σ(</span></span>HMLt_time <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_disj <span class="main">(</span>acset <span class="main">{</span>
        HML_poss <span class="keyword1"><span class="free">ε[</span></span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main"><span class="free">]</span></span> <span class="main">(</span>HML_poss <span class="free">t</span> <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span><span class="main">,</span>
        HML_poss <span class="free">t_ε</span> <span class="main">(</span>HML_poss <span class="keyword1"><span class="free">ε[</span></span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main"><span class="free">]</span></span> <span class="main">(</span>HML_poss <span class="free">t</span> <span class="keyword1"><span class="free">σ(</span></span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span><span class="main">)</span><span class="main">)</span>
      <span class="main">}</span><span class="main">)</span>›</span></span>
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">⊆</span> visible_actions <span class="main">⟹</span>
      <span class="keyword1"><span class="free">σ(</span></span>HMLt_time <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main"><span class="free">)</span></span> <span class="main">=</span> HML_false›</span></span>  
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> HMLt_formula.exhaust<span class="main"><span class="keyword3">,</span></span> <span class="operator">auto</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> distinctness_special_actions<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main"><span class="keyword3">,</span></span> <span class="operator">metis</span> distinctness_special_actions<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span> <span class="quoted"><span class="plain_text">‹Again, we show that the function terminates using a well-founded relation.›</span></span>

<span class="keyword1"><span class="command">inductive_set</span></span> <span class="entity">sigma_wf_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">(</span><span class="tfree">'a</span><span class="main">)</span>HMLt_formula<span class="main">)</span> rel›</span></span> 
  <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">‹<span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="keyword1">∈<span class="hidden">⇩</span><sub>c</sub></span> <span class="free"><span class="bound"><span class="entity">Φ</span></span></span> <span class="main">⟹</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">,</span> HMLt_conj <span class="free"><span class="bound"><span class="entity">Φ</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">sigma_wf_rel</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">,</span> HMLt_neg <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">sigma_wf_rel</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">,</span> HMLt_poss <span class="free"><span class="bound"><span class="entity">α</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">sigma_wf_rel</span>›</span></span> 
  <span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">,</span> HMLt_time <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">sigma_wf_rel</span>›</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">lemma</span></span><span class="comment1">✐<span class="quoted"><span class="quoted">‹tag <span class="main"><span class="main">(</span></span>proof<span class="main"><span class="main">)</span></span> unimportant›</span></span></span> sigma_wf_rel_is_wf<span class="main">:</span> <span class="quoted"><span class="quoted">‹wf sigma_wf_rel›</span></span> 
  <span class="keyword1"><span class="command">unfolding</span></span> wf_def
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> allI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> impI<span class="main"><span class="keyword3">,</span></span> <span class="operator">rule</span> allI<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">)</span>HMLt_formula <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">t</span><span class="main">::</span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">)</span>HMLt_formula›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> sigma_wf_rel <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">y</span><span class="main">)</span> <span class="main">⟶</span> <span class="skolem">P</span> <span class="bound">x</span>›</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span> <span class="skolem">t</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">induction</span> <span class="quoted"><span class="skolem">t</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> HMLt_formula.distinct<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">,</span></span>5<span class="main"><span class="main">)</span></span> HMLt_formula.inject<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> sigma_wf_rel.cases cin.rep_eq<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> HMLt_formula.distinct<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>8<span class="main"><span class="main">,</span></span>10<span class="main"><span class="main">)</span></span> HMLt_formula.inject<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> sigma_wf_rel.cases<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> HMLt_formula.distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">,</span></span>7<span class="main"><span class="main">,</span></span>11<span class="main"><span class="main">)</span></span> HMLt_formula.inject<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> sigma_wf_rel.cases<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> HMLt_formula.distinct<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">,</span></span>9<span class="main"><span class="main">,</span></span>11<span class="main"><span class="main">)</span></span> HMLt_formula.inject<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span> sigma_wf_rel.cases<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">done</span></span></span></span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="comment1">(*&gt;*)</span>


<span class="keyword1"><span class="command">termination</span></span> <span class="quoted">HMt_mapping</span> <span class="keyword1"><span class="command">using</span></span> sigma_wf_rel_is_wf <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">standard</span><span class="main"><span class="keyword3">,</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> cin.rep_eq sigma_wf_rel.intros<span class="main">)</span><span class="main"><span class="keyword3">+</span></span><span class="main">)</span>

<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹of <span class="antiquoted"><span class="raw_text"><span class="operator">‹</span>context lts_timeout_mappable›</span></span>›</span>
<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span> <span class="comment1">― ‹of ‹theory››</span>
<span class="comment1">(*&gt;*)</span></pre>
</body>

</html>